let pwJ = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%*#?&])[A-Za-z\d$@$!%*#?&]{8,}$/;
let nameJ = /^[가-힣]{2,6}$/;
let idJ = /^[a-z0-9]{4,12}$/;

$("#usernameCheck").blur(() => {

	let username = $("#usernameCheck").val();

	$.ajax({
		type: "get",
		url: `/auth/${username}`,
	}).done(res => {

		if (res == true) {
			$("#checkFont").text("사용중인 아이디입니다.");
			$("#checkFont").css("color", "red");
		} else {

			if (idJ.test(username)) {
				$("#checkFont").text("");
			}
		}

	}).fail(error => {
		console.log(JSON.stringify(error));
	});
})

auth = {
	init: function() {

		$("#btnUserUpdate").on("click", () => {
			this.btnUserUpdate();
		})
	},


	btnUserUpdate: function() {

		let data = {
			userId: $("#userId").val(),
			password: $("#password").val(),
			name: $("#name").val(),
			phone: $("#phone").val()
		}

		let userUpdateConfirm = confirm("회원정보를 수정하시겠습니까?");

		if (userUpdateConfirm == true) {
			$.ajax({
				type: "put",
				url: `/api/auth/${data.userId}/update`,
				data: JSON.stringify(data),
				contentType: "application/json; charset-utf-8",
				dataType: "json"
			}).done(res => {
				alert(JSON.stringify(data));
				location.href = "/";
			}).fail(error => {
				alert(JSON.stringify(error));
			});
		} else {
			return false;
		}
	}
}


auth.init();